<body>
<div id="code"></div>
<script type="text/javascript">
	var className = 'UserEntity';
	var data = {
    "username": "saitama",
    "firstName": "Stupid",
    "lastName": "Crazy",
    "fullName": "Caped Baldy",
    "avatarUrl": "http://i3.kym-cdn.com/photos/images/original/001/050/209/b01.png",
    "balance": 10000,
    "fansCount": 1234,
    "premiumFansCount": 123,
    "trophiesCount": 12,
    "totalDonation": 999999,
    "description": "zZz"
  }

function getType(v) {
	var type = typeof v
	if (type == 'number') {
		return 'Int';
	} else if (type == 'string') {
		return 'String';
	} else if (type == 'boolean') {
		return 'Boolean';
	} else {
		return '____';
	}
}

function getTypeLowerCase(v) {
	var type = getType(v);
	return type.charAt(0).toLowerCase() + type.slice(1);
}

var code = '';

code += 'import SQLite\n';
code += 'import SwiftyJSON\n\n';
code += 'class ' + className + ': BaseEntity {\n';

for (var i in data) {
	code += 'var ' + i + ': ' + getType(data[i]) + '\n';
}

code += '\n\n';

code += 'init (id: Int64';
for (var i in data) {
	code += ', ' + i + ': ' + getType(data[i])
}
code += ') {\n';

for (var i in data) {
	code += 'self.' + i + ' = ' + i + '\n';
}
code += 'super.init(id: id)\n';

code += '}\n\n';

code += 'public override func encode(with aCoder: NSCoder) {\n';
code +='super.encode(with: aCoder)\n';
for (var i in data) {
	code += 'aCoder.encode(' + i + ', forKey: "' + i + '")\n';
}
code += '}\n\n';

code += 'public required init?(coder aDecoder: NSCoder) {\n'
for (var i in data) {
	var type = getType(data[i])
	if (type == 'String') {
		code += 'self.' + i + ' = aDecoder.decodeObject(forKey: "' + i + '") as! String\n';
	}
	else {
		code += 'self.' + i + ' = aDecoder.decode' + type + '(forKey: "' + i + '")\n';
	}
}
code += 'super.init(coder: aDecoder)\n';
code += '}\n\n';

code += 'required init(fromJson json: JSON!){\n';
for (var i in data) {
	code += i + ' = json["' + i + '"].' + getTypeLowerCase(data[i]) + 'Value\n';
}
code += 'super.init(fromJson: json)\n';
code += '}\n\n';

code += 'func toDictionary() -> NSDictionary {\n';
code += 'let dictionary = NSMutableDictionary()\n';
for (var i in data) {
	//code += 'if ' + i + ' != nil {\n';
	code += 'dictionary["' + i + '"] = ' + i + '\n';
	//code += '}\n';
}
code += 'return dictionary\n';
code += '}\n\n';

for (var i in data) {
	code += 'static let ' + i + 'Column = Expression<' + getType(data[i])  + '>("' + i + '")\n'
}

code += '\n';

code += 'open override class func createTable(builder: TableBuilder) {\n'
code += 'BaseEntity.createTable(builder: builder)\n'
for (var i in data) {
	code += 'builder.column('  + className + '.' + i + 'Column)\n';
}
code += '}\n\n\n';

code += 'override public class func toEntity(_ row: Row) -> ' + className+ ' {\n';
code += 'return ' + className + '(\n';
code += 'id: row[ContactEntity.idColumn]'
for (var i in data) {
	code += ',\n' + i + ': row[' + className + '.' + i + 'Column]'
}
code += ')\n\n}\n\n';

code += 'override open var columnValues: [Setter]! {\n';
code += 'get {\n';
code += 'return [\n';
code += 'BaseEntity.idColumn <- self.id';
for (var i in data) {
	code += ',\n' + className + '.' + i + 'Column <- self.' + i
}

code += ']\n}\n}\n';

code += '}\n';
document.getElementById('code').innerText = code;
</script>
<body>